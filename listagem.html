<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trabalho de Frameworks</title>
    <link rel="stylesheet" href="listagem.css">

</head>
<body>
    
    <a href="cadastro.html">Adicionar Ao Grimóprio</a>
    <h1>Consultar os Grimórios</h1>

        <!--LUA-->

            <div class="content">
                <div class="lua-efeito"></div>
            </div>
            
        <!--Fundo-->
            <div class="container" id="container"></div>


    </ul>
    
     <!--Configuração de fundo-->

    <script>
        const container = document.getElementById('container');
        const numEstrelas = 150;
      
        for (let i = 0; i < numEstrelas; i++) {
          const estrela = document.createElement('div');
          estrela.classList.add('estrela');
          estrela.style.left = Math.random() * 100 + 'vw';
          estrela.style.top = Math.random() * 100 + 'vh';
          estrela.style.animationDelay = Math.random() * 10 + 's';
          container.appendChild(estrela);
        }
    </script>
     
     
    <!-- BOTÃO -->

    <div class="interface-superior">
        <ul id="minhalista"></ul>
      </div>
      <button id="botaoListar">Listar Grimórios</button>
      <button id="parardelistar">Parar de listar</button>
    

      </script>
      <script>
      async function buscaDados(){
        const resposta = await fetch("http://localhost:8000/Grimorio")
        console.log(resposta)

        if(resposta.status ===200){
            const dados = await resposta.json()
            console.log(dados)
            console.log(dados[0].nome)

            const ul = document.getElementById("minhalista")
            ul.innerHTML = "" //limpar o campo antes de adicionar outro

            for (let i = 0; i < dados.length; i++) {
                const element = dados[i];
                const novoli = document.createElement("li")
                novoli.innerText = element.nome
                ul.appendChild(novoli)
            }

        } else if(resposta.status === 400){
            const dados = await resposta.json()
            alert(dados.mensagem)
        } else {
            alert("ERRO NÃO IDENTIFICADO");
        }
    }

    // OUVINTE DO BOTÃO
    document.getElementById("botaoListar").addEventListener("click", buscaDados)



    </script>
</body>
</html>